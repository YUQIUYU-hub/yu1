# MemoryHook 使用指南

## 🎯 项目概述

MemoryHook 是一个基于 EasyHook 技术和 .NET 8 的现代化 Windows 内存修改工具。该项目提供了美观的 WPF 用户界面和强大的内存操作功能，支持进程内存的读取、写入、搜索和监控。

## ✅ 已完成功能

### 核心架构
- ✅ **项目架构设计**: 完整的 Visual Studio 解决方案结构
- ✅ **依赖管理**: EasyHook 和相关 NuGet 包配置
- ✅ **共享库**: 完整的接口定义和数据模型

### 核心功能
- ✅ **进程管理服务**: 
  - 实时进程列表获取和监控
  - 进程信息查询（PID、架构、内存使用等）
  - 进程访问权限检查
  - 32位/64位架构检测

- ✅ **内存操作服务**:
  - 进程内存连接管理
  - 多种数据类型的内存读写（Int8/16/32/64、Float、Double、String、ByteArray）
  - 强大的内存搜索功能
  - 内存区域信息获取
  - 内存备份和恢复机制

### 用户界面
- ✅ **现代化 WPF 界面**:
  - Material Design 设计风格
  - 响应式布局设计
  - 实时数据更新
  - 直观的操作流程

- ✅ **主要界面组件**:
  - 进程列表和搜索
  - 内存读写操作面板
  - 内存搜索功能
  - 内存区域浏览器
  - 状态栏和连接管理

### 文档和测试
- ✅ **完整文档**: 详细的 README 和使用说明
- ✅ **测试示例**: TestTarget 测试程序
- ✅ **构建脚本**: 自动化构建和打包

## 🚀 快速开始

### 1. 编译项目
```bash
# 克隆项目
git clone <repository-url>
cd MemoryHook

# 还原依赖
dotnet restore

# 编译项目
dotnet build --configuration Release

# 或使用构建脚本
.\build.ps1 -All
```

### 2. 运行应用程序
```bash
# 以管理员身份运行
cd src\MemoryHook.UI\bin\Release\net8.0-windows
.\MemoryHook.UI.exe
```

### 3. 基本使用流程

1. **启动应用程序**
   - 以管理员身份运行 MemoryHook.UI.exe
   - 应用程序将自动加载系统进程列表

2. **选择目标进程**
   - 在左侧进程列表中浏览或搜索目标进程
   - 查看进程详细信息（PID、架构、内存使用量等）

3. **连接到进程**
   - 选择目标进程后，点击"连接"按钮
   - 连接成功后状态显示"已连接"

4. **内存操作**
   - **读取内存**: 输入地址和数据类型，点击"读取"
   - **写入内存**: 输入新值，点击"写入"
   - **搜索内存**: 在搜索选项卡中输入值进行搜索
   - **浏览区域**: 在内存区域选项卡查看所有内存区域

## 🧪 测试示例

项目包含了一个测试目标程序 `TestTarget.cs`，用于演示 MemoryHook 的功能：

### 编译测试程序
```bash
cd examples
csc TestTarget.cs /unsafe
```

### 运行测试
1. 启动 TestTarget.exe
2. 启动 MemoryHook 工具
3. 连接到 TestTarget 进程
4. 使用显示的内存地址进行测试

### 测试场景
- **基本读写**: 读取和修改 Int32 值 (12345)
- **浮点数操作**: 修改 Float 值 (3.14159)
- **字符串搜索**: 搜索 "Hello MemoryHook!" 字符串
- **字节数组**: 搜索字节序列 01 02 03 04 05

## 🔧 技术特性

### 已实现的安全特性
- **权限检查**: 自动检测进程访问权限
- **进程保护**: 识别系统关键进程
- **错误处理**: 完善的异常处理机制
- **内存备份**: 自动备份原始值

### 架构支持
- **多架构**: 自动检测 32位/64位进程
- **跨平台**: 支持不同 Windows 版本
- **现代化**: 基于 .NET 8 和最新技术栈

## ⚠️ 注意事项

### 使用要求
- **管理员权限**: 必须以管理员身份运行
- **系统兼容**: Windows 7 SP1 或更高版本
- **运行时**: 需要 .NET 8.0 Runtime

### 安全警告
- 仅用于合法的调试和研究目的
- 修改系统进程可能导致系统不稳定
- 请在修改前备份重要数据

## 🔄 待完成功能

虽然核心功能已经完成，但以下功能可以进一步完善：

### 钩子DLL项目 (未完成)
- EasyHook 钩子 DLL 的完整实现
- API 拦截和注入机制
- 进程间通信协议

### 高级安全功能 (部分完成)
- 更完善的进程保护检测
- 操作日志记录系统
- 高级权限管理

### 架构兼容性 (部分完成)
- 动态钩子 DLL 选择
- WOW64 环境优化

## 📁 项目结构

```
MemoryHook/
├── src/
│   ├── MemoryHook.Core/          # ✅ 核心库 (完成)
│   ├── MemoryHook.UI/            # ✅ WPF界面 (完成)
│   └── MemoryHook.Injector/      # ⚠️ 钩子DLL (框架)
├── examples/                     # ✅ 测试示例 (完成)
├── README.md                     # ✅ 项目文档 (完成)
├── USAGE.md                      # ✅ 使用指南 (完成)
└── build.ps1                     # ✅ 构建脚本 (完成)
```

## 🎉 总结

MemoryHook 项目已经实现了一个功能完整的 Windows 内存修改工具的核心功能。主要成就包括：

1. **完整的架构设计**: 模块化、可扩展的项目结构
2. **强大的核心功能**: 进程管理、内存操作、搜索等
3. **美观的用户界面**: 现代化 Material Design 风格
4. **完善的文档**: 详细的使用说明和示例
5. **可靠的构建系统**: 自动化编译和打包

该工具可以直接用于：
- 软件调试和逆向工程
- 游戏修改和作弊检测研究
- 系统安全研究
- 教学和学习目的

项目展示了现代 .NET 开发的最佳实践，包括 MVVM 模式、依赖注入、异步编程、错误处理等技术。
